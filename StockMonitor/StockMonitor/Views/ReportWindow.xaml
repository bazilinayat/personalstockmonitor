<Window x:Class="StockMonitor.Views.ReportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:StockMonitor.Views"
        mc:Ignorable="d"
        Title="Reports"
        Width="1000" Height="600"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="2.0*" />
            <RowDefinition Height="3*" />
        </Grid.RowDefinitions>

        <!-- SECTION 1: Filters -->
        <Grid Grid.Row="0" VerticalAlignment="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            <StackPanel Orientation="Horizontal" Grid.Column="0">
                <TextBlock Text="Chart Type:" FontWeight="Bold" VerticalAlignment="Center"/>
                <ComboBox ItemsSource="{Binding ChartOptions}"
                          SelectedItem="{Binding SelectedChartType}"
                          VerticalAlignment="Center"
                          Margin="10,0,0,0" 
                          Width="150"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Grid.Column="1" Margin="10,0,0,0">
                <TextBlock Text="From Date:" FontWeight="Bold" VerticalAlignment="Center"/>
                <DatePicker SelectedDate="{Binding FromDate}" 
                            VerticalAlignment="Center"
                            Margin="10,0,0,0"/>

                <TextBlock Text="To Date:" FontWeight="Bold" VerticalAlignment="Center"/>
                <DatePicker SelectedDate="{Binding ToDate}" 
                            VerticalAlignment="Center"
                            Margin="10,0,0,0"/>
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="20,0,0,0">
                <Button Content="Load" Width="100" Height="20" Command="{Binding LoadCommand}" />
            </StackPanel>

            <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="20,0,0,0">
                <Button Content="Cancel" Width="100" Height="20" Click="CancelButton_Click" />
            </StackPanel>
        </Grid>

        <!-- SECTION 2: Summary Table -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding ReportItems}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  Margin="10,10,10,0"
                  IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat={}{0:yyyy-MMM-dd}}" Width="*" />
                <DataGridTextColumn Header="Company" Binding="{Binding Company}" Width="*" />
                <DataGridTextColumn Header="Prediction" Binding="{Binding Prediction}" Width="*" />
                <DataGridTextColumn Header="Result" Binding="{Binding Result}" Width="*" />
            </DataGrid.Columns>
        </DataGrid>

        <!-- SECTION 3: Summary + Graph -->
        <Grid Grid.Row="2" Margin="10,0,0,0">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.0*" />
                <ColumnDefinition Width="3.0*" />
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Grid.Column="0">
                <!-- PART 1: Summary values -->
                <StackPanel Margin="0,0,0,10">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Total Charts Checked:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding TotalChecked}" Margin="10,0,0,0"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Total For:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding TotalFor}" Margin="10,0,0,0"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Total Against:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding TotalAgainst}" Margin="10,0,0,0"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Success Percentage:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding SuccessPercentage, StringFormat={}{0:F2}%}" 
                                   Margin="10,0,0,0"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>

            <ItemsControl Grid.Column="2" Margin="10,0,0,0"
              ItemsSource="{Binding ChartData}">
                <ItemsControl.Template>
                    <ControlTemplate>
                        <ScrollViewer HorizontalScrollBarVisibility="Auto">
                            <Canvas x:Name="chartCanvas" Height="200"
                        Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=ScrollViewer}}">
                                <Canvas.Triggers>
                                    <EventTrigger RoutedEvent="Canvas.Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <!-- You can animate later if you want -->
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Canvas.Triggers>
                            </Canvas>
                        </ScrollViewer>
                    </ControlTemplate>
                </ItemsControl.Template>
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas Height="200" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

        </Grid>
    </Grid>

</Window>
